<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>View Messages</title>
<script type="text/javascript" src="datetimepicker_css.js"></script>
<script type="text/javascript" src="jquery-latest.js"></script>
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery-ui.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/styles.css" />
<script src="js/jquery.js"></script>
<script src="js/keynav.js"></script>
<script src="js/sliding_effect.js"></script>
<script src="js/interface.js"></script>

<SCRIPT type="text/javascript">
	//document.addEventListener('keypress', sendButtonPressed, true);
	function sendButtonPressed(e)
	{
	var key_code = event.keyCode;
	var v_key    = map_key(key_code);
	if (v_key == 27) //key escape to show weather+news
	{	
	close_window();
	e.returnValue=false;
	}	
	}

	function close_window()
	{
	FrameworkPlugin.tcs_loadApp('/demo/stb/html-apps/apps/settings/settings.html');
	return;
	}

	var state = 0;
	function gup( url, name )
	{
	name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");  
	var regexS = "[\\?&]"+name+"=([^&#]*)"; 
	var regex = new RegExp( regexS );  
	var results = regex.exec(url);//regex.exec( window.location.href );  
	if( results == null )   
	return "";  
	else   
	return results[1];
	}	
	
</SCRIPT>	
<script type="text/javascript">

function call(text)
{
	//alert(text);
	var name=new Array("facebook","twitter","linkedin","youtube","gingerhotel","gingerfeedback");
	var link=new Array("http://www.facebook.com",
			"http://www.twitter.com/",
			"http://www.linkedin.com/",
			"http://www.youtube.com/",
			"http://www.gingerhotels.com/",
			"http://www.gingerhotels.com/contactus/Customer_Feedback.aspx"
	);			
	for(var i=0;i<name.length;i++)
	{
		if(text==name[i])
		{
			//window.location=link[i];
			  //alert("link"+link[i]);
			  window.open(link[i],'_blank');
			
		}
	}
}
function callhref(text)
{
	//alert(text);
	if(text=="index1")
	{
		window.location.href=text+".jsp";
	}
	else	
		window.location.href=text+".html";
		//window.open(text+".html",'_blank');
	//window.location.href=location of file on server
}
</script>
<script type="text/javascript">
	
	$(document).ready(
		function()
		{
			
			$('#dock2').Fisheye(
				{
					maxWidth: 60,
					items: 'a',
					itemsText: 'span',
					container: '.dock-container2',
					itemWidth: 80,
					proximity: 80,
					alignment : 'left',
					valign: 'bottom',
					halign : 'center'
				}
			)
		}
	);

</script>
<SCRIPT type="text/javascript">
	/*function sendButtonPressed(e)
	{
	var key_code = event.keyCode;
	var v_key    = map_key(key_code);
	if (v_key == 27) //key escape to show weather+news
	{	
	close_window();
	e.returnValue=false;
	}	
	}
	function close_window()
	{
	FrameworkPlugin.tcs_loadApp('/demo/stb/html-apps/apps/settings/settings.html');
	return;
	}
	var state = 0;
function gup( url, name )
	{
	name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");  
	var regexS = "[\\?&]"+name+"=([^&#]*)"; 
	var regex = new RegExp( regexS );  
	var results = regex.exec(url);//regex.exec( window.location.href );  
	if( results == null )   
	return "";  
	else   
	alert(results[1]);
	return results[1];
	}	
*/
function onSuccess() { 	
	
	/*var urlDisplay = 'http://172.17.199.87:8080/RestWebService/rest/automatedMsgDisp?roomId=109&callback=onDisplay';
	//alert("urlDisplay:-"+urlDisplay);
	state = gup( window.location.href, 'param');
	$.getScript(urlDisplay);
	}
	
	function onDisplay() {
	*/
	var msg="this.className='readmsg';ChangeCSS(this,0,0);";
	var html = "<table style='margin-top: 120px; font-size: 12px; position: relative; width: 540px; ' align='center' class='sample' cellspacing='1' cellpadding='3' id='results'><thead style='background-color: #CDB38B; '><tr height='20px'><td><a style='color:white' onclick='SortTable(0);' href='javascript:;'>From</a></td><td><a style='color:white' onclick='SortTable(1);' href='javascript:;'>To</a></td><td><a style='color:white' onclick='SortTable(2);' href='javascript:;'>Date</a></td><td><a style='color:white;' onclick='SortTable(3);' href='javascript:;'>Subject</a></td></tr></thead><tbody>";

	html += "<tr height='20px'><td class='readmsg'>Reception</td><td class='readmsg'>James Gates</td><td class='readmsg'>10-06-2012</td><td><a href='#' class='readmsg' onclick=this.className='readmsg';ChangeCSS(this,0,0); onblur='javascript: hideOutDiv(0);'  >Missed Call Information</a><span class='hint' id='msgId0' ><u>Message:</u><br>You missed a call from Sarah at 4:20pm<span class='hint-pointer'>&nbsp;</span></span></td></tr>";
	
	html += "<tr height='20px'><td class='readmsg'>Spa </td><td class='readmsg'>John Miller</td><td class='readmsg'>10-06-2012</td><td><a href='#' class='readmsg' onclick=this.className='readmsg';ChangeCSS(this,1,1); onblur='javascript: hideOutDiv(1);'  >Spa Reservation Confirmation</a><span class='hint' id='msgId1' ><u>Message:</u><br>Your Spa Reservation details:<br>Date: 12 June,2012 Time:3-4pm<span class='hint-pointer'>&nbsp;</span></span></td></tr>";
	
	html += "<tr height='20px'><td class='unreadmsg'>Hotel Security</td><td class='unreadmsg'>John Miller</td><td class='unreadmsg'>10-06-2012</td><td><a href='#' class='unreadmsg' onclick=this.className='readmsg';ChangeCSS(this,2,2); onblur='javascript: hideOutDiv(2);'  >Fire Alert</a><span class='hint' id='msgId2' ><u>Message:</u><br>Fire Alert:<br>Please evacuate the property and make a safe exit through the stairs<span class='hint-pointer'>&nbsp;</span></span></td></tr>";
	
	html += "<tr height='20px'><td class='unreadmsg'>Cab Services</td><td class='unreadmsg'>John Miller</td><td class='unreadmsg'>11-06-2012</td><td><a href='#' class='unreadmsg' onclick=this.className='readmsg';ChangeCSS(this,3,3); onblur='javascript: hideOutDiv(3);' >Taxi Booking Confirmation</a><span class='hint' id='msgId3' ><u>Message:</u><br>You have booked a cab for<br>Date:12th June,2012<br>Destination:Airport<br>No.of passengers:2<span class='hint-pointer'>&nbsp;</span></span></td></tr>";
	
	html += "<tr height='20px'><td class='readmsg'>Reception</td><td class='readmsg'>Harry Cooper</td><td class='readmsg'>11-06-2012</td><td><a href='#' class='readmsg' onclick=this.className='readmsg';ChangeCSS(this,4,4); onblur='javascript: hideOutDiv(4);' >Missed Call Information</a><span class='hint' id='msgId4' ><u>Message:</u><br>You missed a call from James at 9 p.m. IST<span class='hint-pointer'>&nbsp;</span></span></td></tr>";
	
	html+="</tbody></table>";
	/*var i;
	if(data.totalCount==0)
	{
	html += "<TR><TD colspan='3'>No Messages Available</TD>	</TR>";
    }
	else
	{
		for(i=0; i<data.totalCount; i++) { 
	
		   var cssDisp= "unreadmsg";

			if(data.automatedMsgVO[i].msg_status=="R"){
					cssDisp="readmsg";
			}

			var msgDisp;
			if(data.automatedMsgVO[i].msg_messages==null){
					msgDisp = data.automatedMsgVO[i].msg_subject;
			}else{
					msgDisp = data.automatedMsgVO[i].msg_messages;
			}
		var msg="this.className='readmsg';ChangeCSS(this,"+data.automatedMsgVO[i].msg_id+","+i+");";

		html += "<tr height='20px'><td class='"+cssDisp+"'>"+ data.automatedMsgVO[i].msg_from + " </td><td class='"+cssDisp+"'>"+ data.automatedMsgVO[i].msg_guestname + "</td><td class='"+cssDisp+"'>"+ data.automatedMsgVO[i].msg_datetime +"</td><td class='"+cssDisp+"' ><a href='#' class='"+cssDisp+"' onclick="+msg+"  onblur='javascript: hideOutDiv("+i+");' >"+data.automatedMsgVO[i].msg_subject+"</a><span class='hint' id='msgId"+i+"' ><u>Message:</u><br>"+msgDisp+"<span class='hint-pointer'>&nbsp;</span></span></td></tr>";
		}
		html+="</tbody></table>";
	//alert(html);
	}*/
	
   document.getElementById("displayMsg").innerHTML = html;
	}	

var sortedOn = 0;
function SortTable(sortOn) {
//alert("Hi");
		var table = document.getElementById('results');
		var tbody = table.getElementsByTagName('tbody')[0];
		var rows = tbody.getElementsByTagName('tr');

		var rowArray = new Array();
		for ( var i = 0, length = rows.length; i < length; i++) {
			rowArray[i] = new Object;
			rowArray[i].oldIndex = i;
			rowArray[i].value = rows[i].getElementsByTagName('td')[sortOn].firstChild.nodeValue;
		}

		if (sortOn == sortedOn) {
			rowArray.reverse();
		} else {
			sortedOn = sortOn;
			/*  
			 Decide which function to use from the three:RowCompareNumbers,  
			 RowCompareDollars or RowCompare (default).  
			 For first column, I needed numeric comparison.  
			 */
			if (sortedOn == 0) {
				rowArray.sort(RowCompare);
			} else {
				rowArray.sort(RowCompare);
			}
		}

		var newTbody = document.createElement('tbody');
		for ( var i = 0, length = rowArray.length; i < length; i++) {
			newTbody.appendChild(rows[rowArray[i].oldIndex].cloneNode(true));
		}

		table.replaceChild(newTbody, tbody);
	}

	function RowCompare(a, b) {

		var aVal = a.value;
		var bVal = b.value;
		return (aVal == bVal ? 0 : (aVal > bVal ? 1 : -1));
	}
	// Compare number   
	function RowCompareNumbers(a, b) {

		var aVal = parseInt(a.value);
		var bVal = parseInt(b.value);
		return (aVal - bVal);
	}
	// compare currency   
	function RowCompareDollars(a, b) {

		var aVal = parseFloat(a.value.substr(1));
		var bVal = parseFloat(b.value.substr(1));
		return (aVal - bVal);
	}

	
	
</script>

<style type="text/css">
.hint {
	display: none;
	position: absolute;
	right: 100px;
	width: 250px;
	margin-top: -4px;
	border: 1px solid #c93;
	padding: 10px 12px;
	font-family: cursive;
	font-weight: bold;
	background: #ffc url(images/pointer.gif) no-repeat -10px 5px;
}

/* The pointer image is hadded by using another span */
.hint .hint-pointer {
	position: absolute;
	right: -10px;
	top: 3px;
	width: 10px;
	height: 19px;
	background: url(images/pointer.gif) left top no-repeat;
}

.unreadmsg {
	text-decoration: none;
	font: italic;
	color: #C11B17;
	font-weight: bold;
	font-size: 12px;
}

.readmsg {
	text-decoration: none;
	color: #387C44;
	font-weight: normal;
	font-size: 12px;
}
body {
	background-image: url();
	background-color: #AEBF76;
	margin-left: 225px;
	margin-top: 50px;
	
	font-size:14px;
	font-family: Verdana;
}
</style>

<script type="text/javascript">
function ChangeCSS(valObj,msgId,j)
{
	//alert("--->"+valObj.parentNode.parentNode.rowIndex);

	var table = valObj.parentNode.parentNode.parentNode;
	var rowIndex = valObj.parentNode.parentNode.rowIndex-1;
	
	//alert("rowIndex :--->"+rowIndex);
	var trs= eval("table.childNodes["+rowIndex+"]");
	//alert("trs :"+trs.innerHTML)
	var length = trs.childNodes.length;
	
	//alert("child nodes length :--->"+length)
	
	//alert("innerhtml :--->"+trs.childNodes[3].innerHTML);
	for(var i=0;i<length;i++)
	{
		var tds = eval("trs.childNodes["+i+"]");
		tds.className='readmsg';
	}
	
	//alert("child Nodes length :--->"+valObj.parentNode.parentNode.ChildNodes[rowIndex].childNodes.length ); 
	
	var tabLen = document.getElementById("results").rows.length;
	//validateMsgId(valObj,msgId);

	valObj.parentNode.parentNode.className='readmsg'; 
	valObj.parentNode.className='readmsg';
	valObj.className='readmsg';
	//alert("vobj:-"+valObj.parentNode.className);

	var msgId1="msgId"+j;
//	alert("showDiv ::-"+msgId1);
	document.getElementById(msgId1).style.display = "inline";
	
}

/*function callCSS()
{

	 var table=element.parentNode.parentNode; 
	  
	 //alert(table.childNodes[1].childNodes.length) 

	 for(var count=0; count< table.childNodes[1].childNodes.length; count++){ 
	  //alert(count)
	 }  
}

var req;
//var xmlHttpRequest;


function validateMsgId(valObj,msgId) {
	//alert("we r in validateMsgId valObj:--->"+valObj.parentNode.parentNode.rowIndex);
	//alert(" validate MsgId :--->"+msgId);
   //var idField = document.getElementById("userid");
  var updateMsgURL = "http://172.17.199.87:8080/RestWebService/rest/updateAutomatedMsg?msgId="+msgId;
//  alert(updateMsgURL);
   try
   {   
	   req = new XMLHttpRequest();  
   }
   catch(e)
   {   
		try
		{     
			req = new ActiveXObject("Msxml2.XMLHTTP");     
		}
		catch(e)
		{     
			 try
			 { 
				 req = new ActiveXObject("Microsoft.XMLHTTP");       
			 }
			 catch(e)
			 {  
			  document.getElementById("dismsg").innerHTML = "Your browser does not support AJAX.";
			  //alert("Your browser does not support AJAX.");       
			  return false;       
			 }     
        }   
   }
   req.open("GET", updateMsgURL, true);
   req.onreadystatechange = function(valObj){
	   if(req.readyState == 4)
		  {
			   if(req.status == 200)
			   {
				   //success
			   }
			   else
			   {
			    document.getElementById("dismsg").innerHTML = "Error: "+ req.statusText ;
				//alert("Error: "+ req.statusText +" "+ req.status);
			   }
		  }	   
    };
   req.send(null);
}
function callback() {
	//alert("we r in callback valObj:--->"+valObj);
	
}*/


</script>
<style type="text/css">
.sample {
	border-width: 0px;
	border-spacing: 0;
	border-collapse: collapse;
	border-style: outset;
	border-color: #DDDDDD;
}

.sample th {
	border-width: 1px;
	padding: 1px;
	border-style: inset;	
	border-color: #DDDDDD;
	border: 0px solid #DDDDDD;	
}

.sample td {
	border-width: 1px;
	padding: 1px;
	text-align: center;
	border-style: inset;
	border-color: #DDDDDD;
	border: 1px solid #DDDDDD;
	-moz-border-radius: ;
}

.label {
	text-decoration: none;
	text-align: left;
	color: #084B8A;
	font-family: "verdana";
	font-size: 15px;
	font-weight: medium;
}

.heading {
	text-decoration: none;
	color: #084B8A;;
	font-family: "verdana";
	font-size: 18px;
	font-weight: bold;
}

.button {
	text-decoration: none;
	color: #084B8A;
	font-family: "verdana";
	font-size: 12px;
	font-weight: bold;
	background-color: #A9D0F5;
	border: none;
	outline: none;
	width: 60px;
	height: 20px;
	cursor: hand;
}

.button1 {
	text-decoration: none;
	color: #084B8A;
	font-family: "verdana";
	font-size: 12px;
	font-weight: bold;
	background-color: white;
	border: none;
	outline: none;
	width: 65px;
	height: 20px;
	cursor: hand;
}
</style>

</head>
<body onload="javascript:onSuccess();">


<table style="background-color: #FFFFFF; margin-top: 0px; margin-left: 0px; border: 1px solid #666; width: 550px; height: 390px; position: relative; top: 0px; padding-top: 0px;background-image: url('images/email.png'); background-repeat: no-repeat;  background-position: top">
	<tr>
		<td style='color: #585858; font-family: verdana; font-weight: bold; font-size: 18px; background-color: #A9D0F5'
	align="center">View Messages</td>
	</tr>


	<tr>
		<td colspan="3">
		<div id="displayMsg" style="font-family: verdana; width: 500px; background-position: top; height: 155px; ">

	</div>
			<script>
				function showDiv(i){
					//alert("i:-"+i);
					var msgId1="msgId"+i;
					//alert("showDiv ::-"+msgId1);
					document.getElementById(msgId1).style.display = "inline";
				}
				function hideOutDiv(i){
					var msgId1="msgId"+i;
					//alert("hideOutDiv :-"+msgId1);
					document.getElementById(msgId1).style.display = "none";
				}
				
			</script>
	
		</td>
	</tr>
	
		
	
</table>
<div id="dismsg" style="font-family: verdana; width: 500px;"></div>
<div class="dock2" id="dock2">
  <div class="dock-container2">
  <a class="dock-item2" href="javascript:callhref('index1')"><span>Home</span><img src="images/dock/home.png" alt="Home" /></a> 
<!--  <a class="dock-item2" href="javascript:call('gingerhotel')"><span>Ginger Hotels</span><img src="images/dock/ginger.png" alt="Ginger Hotels" /></a> -->
<!--   <a class="dock-item2" href="javascript:callhref('socialnetworks')"><span>Social Networking</span><img src="images/dock/social.png" alt="Social Networking" /></a> --> 
<!--   <a class="dock-item2" href="javascript:callhref('news')"><span>Web Channels</span><img src="images/dock/webchannel.png" alt="Web Channels" /></a> -->
 <!--  <a class="dock-item2" href="javascript:call('youtube')"><span>Youtube</span><img src="images/dock/youtube1.png" alt="InfoEntertainment" /></a> -->
 <!-- <a class="dock-item2" href="javascript:callhref('newspaper')"><span>Newspaper</span><img src="images/dock/newspaper.png" alt="Info Entertainment" /></a>-->
<a class="dock-item2" href="javascript:callhref('feedback')"><span>Feedback</span><img src="images/dock/feedback.png" alt="Feedback" /></a>
  <a class="dock-item2" href="javascript:callhref('spaReservation')"><span>Spa Reservation</span><img src="images/dock/spa.png" alt="Spa Reservation" /></a>
  <a class="dock-item2" href="javascript:callhref('restaurant')"><span>Restaurant Booking</span><img src="images/dock/restaurant.png" alt="Restaurant Booking" /></a>
  <a class="dock-item2" href="javascript:callhref('pickDropService')"><span>Pick and Drop</span><img src="images/dock/pick.png" alt="Pick and Drop" /></a> 
  <a class="dock-item2" href="javascript:callhref('invoice')"><span>Invoice</span><img src="images/dock/invoice.png" alt="Invoice" /></a>
  <a class="dock-item2" href="javascript:callhref('emailLogin')"><span>Find Friends</span><img src="images/dock/friends.png" alt="Find Friends" /></a> 
  </div>
</div>

</body>
</html>